// Internationalization (i18n) for SikuliX IDE

const translations = {
    en: {
        "app.title": "SikuliX IDE",
        "menu.file": "File",
        "menu.file_new": "New",
        "menu.file_open": "Open",
        "menu.file_save": "Save",
        "menu.file_exit": "Exit",
        "menu.run": "Run",
        "menu.run_script": "Run Script",
        "menu.run_stop": "Stop",
        "menu.tools": "Tools",
        "menu.tools_capture": "Screen Capture",
        "menu.tools_pattern_editor": "Pattern Editor",
        "menu.tools_settings": "Settings",
        "menu.help": "Help",
        "menu.help_about": "About",
        "toolbar.run": "Run",
        "toolbar.stop": "Stop",
        "toolbar.capture": "Capture",
        "editor.title": "Script Editor",
        "editor.placeholder": "Enter your SikuliX script here...",
        "output.title": "Output",
        "output.execution_start": "=== Script Execution ===",
        "output.no_script": "No script to run.",
        "output.not_implemented": "[Execution not yet implemented]",
        "python.detected": "Detected",
        "python.python2": "Python 2",
        "python.python3": "Python 3",
        "python.mixed": "Mixed (2+3)",
        "python.unknown": "Unknown",
        "python.python2_convert": "Python 2 (will be converted to Python 3)",
        "python.mixed_review": "Mixed (Python 2+3 detected, needs review)",
        "python.unknown_default": "Unknown (treating as Python 3)",
        "about.title": "About SikuliX IDE",
        "about.version": "Version",
        "about.description": "Next-generation GUI automation IDE",
        "about.core_version": "Core",
        "about.close": "Close",
        "settings.title": "Settings",
        "settings.language": "Language",
        "status.ready": "Ready",
        "status.new_file": "New file created",
        "status.file_loaded": "File loaded",
        "status.file_saved": "File saved",
        "dialog.unsaved_changes": "You have unsaved changes. Do you want to discard them?",
        "dialog.confirm": "Confirm",
        "log.search_placeholder": "Search logs...",
        "log.level_all": "All",
        "log.level_debug": "Debug",
        "log.level_info": "Info",
        "log.level_warn": "Warning",
        "log.level_error": "Error",
        "log.clear": "Clear logs",
        "log.script_running": "Running Script",
        "log.script_completed": "Script Completed",
        "log.script_error": "Script Error",
        "log.stop_requested": "Stop requested",
        "log.export": "Export logs",
        "log.exported": "Logs exported successfully",
        "log.no_logs": "No logs to export",
        "log.copied_clipboard": "Logs copied to clipboard",
        "problems.title": "Problems",
        "problems.all": "All",
        "problems.errors": "Errors",
        "problems.warnings": "Warnings",
        "problems.no_problems": "No problems detected",
        "problems.clear": "Clear problems",
        "breakpoints.title": "Breakpoints",
        "breakpoints.hint": "Click glyph margin or F9 to toggle",
        "breakpoints.clear_all": "Clear All",
        "breakpoints.no_breakpoints": "No breakpoints set",
        "breakpoints.enter_condition": "Enter breakpoint condition (leave empty for unconditional):",
        "variables.title": "Variables",
        "variables.scope_local": "Local",
        "variables.scope_global": "Global",
        "variables.scope_all": "All",
        "variables.search_placeholder": "Search variables...",
        "variables.not_debugging": "Not debugging. Run script in debug mode to see variables.",
        "variables.no_variables": "No variables in this scope.",
        "variables.edit_value": "Edit value:",
        "watch.title": "Watch",
        "watch.add_placeholder": "Add expression...",
        "watch.clear_all": "Clear All",
        "watch.no_watches": "No watch expressions. Add an expression to evaluate.",
        "watch.edit_expression": "Edit watch expression:",
        "watch.not_debugging": "Not debugging",
        "watch.edit": "Edit",
        "watch.remove": "Remove",
        "pattern.title": "Pattern Settings",
        "pattern.similarity": "Similarity",
        "pattern.similarity_hint": "Higher values require more exact matches",
        "pattern.target_offset": "Target Offset",
        "pattern.reset_center": "Reset to Center",
        "pattern.offset_hint": "Click on the image to set target point",
        "pattern.test_match": "Test Match",
        "pattern.apply": "Apply",
        "pattern.load_error": "Failed to load image",
        "pattern.testing": "Testing match...",
        "pattern.match_found": "Match found at ({x}, {y}) with score {score}",
        "pattern.no_match": "No match found with current similarity",
        "pattern.test_error": "Test failed: {error}",
        "toolbar.library": "Library",
        "library.title": "Image Library",
        "library.search_placeholder": "Search images...",
        "library.images": "images",
        "library.loading": "Loading...",
        "library.empty": "No images found",
        "library.no_project": "Open a file to see project images",
        "ocr.title": "OCR",
        "ocr.capture": "Capture OCR",
        "ocr.region": "Select Region",
        "ocr.confidence": "Confidence",
        "ocr.no_result": "No OCR result. Click \"Capture OCR\" to recognize text from screen.",
        "ocr.no_text": "No text recognized",
        "ocr.no_text_copy": "No text to copy",
        "ocr.processing": "Processing OCR...",
        "ocr.copied": "Text copied to clipboard",
        "ocr.error": "OCR Error",
        "ocr.lang_eng": "English",
        "ocr.lang_jpn": "Japanese",
        "ocr.lang_eng_jpn": "Eng + Jpn",
        "ocr.region_hint": "Drag to select region for OCR (ESC to cancel)",
        "ocr.region_too_small": "Selection too small",
        "ocr.searching": "Searching...",
        "ocr.search_empty": "Enter text to search",
        "ocr.search_found": "Found {count} matches",
        "ocr.search_not_found": "No matches found"
    },
    ja: {
        "app.title": "SikuliX IDE",
        "menu.file": "ファイル",
        "menu.file_new": "新規",
        "menu.file_open": "開く",
        "menu.file_save": "保存",
        "menu.file_exit": "終了",
        "menu.run": "実行",
        "menu.run_script": "スクリプト実行",
        "menu.run_stop": "停止",
        "menu.tools": "ツール",
        "menu.tools_capture": "スクリーンキャプチャ",
        "menu.tools_pattern_editor": "パターンエディタ",
        "menu.tools_settings": "設定",
        "menu.help": "ヘルプ",
        "menu.help_about": "バージョン情報",
        "toolbar.run": "実行",
        "toolbar.stop": "停止",
        "toolbar.capture": "キャプチャ",
        "editor.title": "スクリプトエディタ",
        "editor.placeholder": "SikuliXスクリプトをここに入力してください...",
        "output.title": "出力",
        "output.execution_start": "=== スクリプト実行 ===",
        "output.no_script": "実行するスクリプトがありません。",
        "output.not_implemented": "[実行機能は未実装です]",
        "python.detected": "検出",
        "python.python2": "Python 2",
        "python.python3": "Python 3",
        "python.mixed": "混在 (2+3)",
        "python.unknown": "不明",
        "python.python2_convert": "Python 2 (Python 3に変換されます)",
        "python.mixed_review": "混在 (Python 2+3検出、要確認)",
        "python.unknown_default": "不明 (Python 3として処理)",
        "about.title": "SikuliX IDE について",
        "about.version": "バージョン",
        "about.description": "次世代GUI自動化IDE",
        "about.core_version": "コア",
        "about.close": "閉じる",
        "settings.title": "設定",
        "settings.language": "言語",
        "status.ready": "準備完了",
        "status.new_file": "新規ファイルを作成しました",
        "status.file_loaded": "ファイルを読み込みました",
        "status.file_saved": "ファイルを保存しました",
        "dialog.unsaved_changes": "未保存の変更があります。破棄しますか？",
        "dialog.confirm": "確認",
        "log.search_placeholder": "ログを検索...",
        "log.level_all": "すべて",
        "log.level_debug": "デバッグ",
        "log.level_info": "情報",
        "log.level_warn": "警告",
        "log.level_error": "エラー",
        "log.clear": "ログをクリア",
        "log.script_running": "スクリプト実行中",
        "log.script_completed": "スクリプト完了",
        "log.script_error": "スクリプトエラー",
        "log.stop_requested": "停止要求",
        "log.export": "ログをエクスポート",
        "log.exported": "ログをエクスポートしました",
        "log.no_logs": "エクスポートするログがありません",
        "log.copied_clipboard": "ログをクリップボードにコピーしました",
        "problems.title": "問題",
        "problems.all": "すべて",
        "problems.errors": "エラー",
        "problems.warnings": "警告",
        "problems.no_problems": "問題は検出されませんでした",
        "problems.clear": "問題をクリア",
        "breakpoints.title": "ブレークポイント",
        "breakpoints.hint": "グリフマージンをクリックまたはF9で切り替え",
        "breakpoints.clear_all": "すべてクリア",
        "breakpoints.no_breakpoints": "ブレークポイントが設定されていません",
        "breakpoints.enter_condition": "ブレークポイント条件を入力（空で無条件）：",
        "variables.title": "変数",
        "variables.scope_local": "ローカル",
        "variables.scope_global": "グローバル",
        "variables.scope_all": "すべて",
        "variables.search_placeholder": "変数を検索...",
        "variables.not_debugging": "デバッグ中ではありません。変数を表示するにはデバッグモードでスクリプトを実行してください。",
        "variables.no_variables": "このスコープに変数がありません。",
        "variables.edit_value": "値を編集:",
        "watch.title": "ウォッチ",
        "watch.add_placeholder": "式を追加...",
        "watch.clear_all": "すべてクリア",
        "watch.no_watches": "ウォッチ式がありません。評価する式を追加してください。",
        "watch.edit_expression": "ウォッチ式を編集:",
        "watch.not_debugging": "デバッグ中ではありません",
        "watch.edit": "編集",
        "watch.remove": "削除",
        "pattern.title": "パターン設定",
        "pattern.similarity": "類似度",
        "pattern.similarity_hint": "高い値はより正確な一致を要求します",
        "pattern.target_offset": "ターゲットオフセット",
        "pattern.reset_center": "中心にリセット",
        "pattern.offset_hint": "画像をクリックしてターゲット位置を設定",
        "pattern.test_match": "マッチテスト",
        "pattern.apply": "適用",
        "pattern.load_error": "画像の読み込みに失敗しました",
        "pattern.testing": "マッチング中...",
        "pattern.match_found": "({x}, {y}) でマッチが見つかりました (スコア: {score})",
        "pattern.no_match": "現在の類似度ではマッチが見つかりませんでした",
        "pattern.test_error": "テスト失敗: {error}",
        "toolbar.library": "ライブラリ",
        "library.title": "画像ライブラリ",
        "library.search_placeholder": "画像を検索...",
        "library.images": "件の画像",
        "library.loading": "読み込み中...",
        "library.empty": "画像が見つかりません",
        "library.no_project": "ファイルを開くとプロジェクトの画像が表示されます",
        "ocr.title": "OCR",
        "ocr.capture": "OCRキャプチャ",
        "ocr.region": "領域選択",
        "ocr.confidence": "精度",
        "ocr.no_result": "OCR結果がありません。「OCRキャプチャ」をクリックして画面からテキストを認識してください。",
        "ocr.no_text": "テキストが認識されませんでした",
        "ocr.no_text_copy": "コピーするテキストがありません",
        "ocr.processing": "OCR処理中...",
        "ocr.copied": "テキストをクリップボードにコピーしました",
        "ocr.error": "OCRエラー",
        "ocr.lang_eng": "英語",
        "ocr.lang_jpn": "日本語",
        "ocr.lang_eng_jpn": "英語 + 日本語",
        "ocr.region_hint": "ドラッグしてOCR領域を選択（ESCでキャンセル）",
        "ocr.region_too_small": "選択領域が小さすぎます",
        "ocr.searching": "検索中...",
        "ocr.search_empty": "検索テキストを入力してください",
        "ocr.search_found": "{count}件のマッチが見つかりました",
        "ocr.search_not_found": "マッチが見つかりませんでした"
    }
};

let currentLanguage = 'en';

function t(key) {
    return translations[currentLanguage][key] || key;
}

function setLanguage(lang) {
    currentLanguage = lang;
    updateUI();
    localStorage.setItem('language', lang);
}

function updateUI() {
    // Update all elements with data-i18n attribute
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        el.textContent = t(key);
    });

    // Update placeholders
    document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        el.placeholder = t(key);
    });

    // Update language display
    const langDisplay = document.getElementById('language-display');
    if (langDisplay) {
        const langName = currentLanguage === 'en' ? 'English' : '日本語';
        langDisplay.textContent = `${t('settings.language')}: ${langName}`;
    }
}

// Initialize language from localStorage
document.addEventListener('DOMContentLoaded', () => {
    const savedLang = localStorage.getItem('language') || 'en';
    currentLanguage = savedLang;
    document.getElementById('language-select').value = savedLang;
    updateUI();
});
